"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[243],{121:(e,t,o)=>{o.d(t,{N:()=>a});function a(e){let t=e;return(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/^### (.*$)/gm,'<h3 class="text-xl font-semibold mb-3">$1</h3>')).replace(/^## (.*$)/gm,'<h2 class="text-2xl font-bold mb-4">$1</h2>')).replace(/^# (.*$)/gm,'<h1 class="text-4xl font-bold mb-6">$1</h1>')).replace(/\*\*(.*?)\*\*/g,'<strong class="font-bold">$1</strong>')).replace(/\*(.*?)\*/g,'<em class="italic">$1</em>')).replace(/^- (.*$)/gm,'<li class="mb-2 ml-4">â€¢ $1</li>')).replace(/(<li.*<\/li>\s*)+/g,'<ul class="space-y-1 mb-4">$&</ul>')).split("\n").map(e=>{let t=e.trim();return""===t||t.startsWith("<h")||t.startsWith("<li")||t.startsWith("<ul")||t.startsWith("</ul>")?e:!t.includes("<")&&t.length>0?'<p class="mb-3 leading-relaxed">'.concat(t,"</p>"):e}).join("\n")).replace(/\n\s*\n/g,"\n")}},7243:(e,t,o)=>{o.d(t,{A:()=>g});var a=o(5155),s=o(2115),l=o(1408),r=o(1733),n=o(9238),i=o(9e3),c=o(9051),d=o(7125),h=o(2987),x=o(1190),u=o(583),p=o(9926),y=o(1360),m=o(6046);let f=()=>({shapes:[],texts:[],version:"1.0"}),b=()=>"ann_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));function g(e){let{slideId:t,initialAnnotations:o,isEditMode:g=!1,isPresentationMode:k=!1,onAnnotationsChange:v,onSave:j,className:w=""}=e,[N,C]=(0,s.useState)(()=>(e=>{if(!e)return f();try{let t=JSON.parse(e);return{shapes:t.shapes||[],texts:t.texts||[],version:t.version||"1.0"}}catch(e){return console.warn("Failed to parse annotation data:",e),f()}})(o)),[M,A]=(0,s.useState)({activeTool:"select",strokeColor:"#ef4444",fillColor:"transparent",strokeWidth:2,fontSize:16,opacity:1}),[W,S]=(0,s.useState)(!1),[D,T]=(0,s.useState)(null),[$,L]=(0,s.useState)([]),[z,E]=(0,s.useState)(null),[_,F]=(0,s.useState)(!1),[R,P]=(0,s.useState)(!1),B=(0,s.useRef)(null),I=(0,s.useRef)(null),J=(0,s.useCallback)(e=>{if(!I.current)return{x:0,y:0};let t=I.current.getBoundingClientRect();return{x:Math.max(0,Math.min(100,(e.clientX-t.left)/t.width*100)),y:Math.max(0,Math.min(100,(e.clientY-t.top)/t.height*100))}},[]),O=(0,s.useCallback)(e=>{if(!g||"select"===M.activeTool)return;e.preventDefault();let t=J(e);if("text"===M.activeTool){let e={id:b(),text:"Click to edit",x:t.x,y:t.y,style:{fontSize:M.fontSize,color:M.strokeColor,fontFamily:"Inter, sans-serif",fontWeight:"normal"},createdAt:Date.now(),updatedAt:Date.now()};C(t=>({...t,texts:[...t.texts,e]})),E(e.id)}else if("path"===M.activeTool)L([t]),S(!0);else{let e={id:b(),type:M.activeTool,x:t.x,y:t.y,width:0,height:0,style:{stroke:M.strokeColor,strokeWidth:M.strokeWidth,fill:M.fillColor,opacity:M.opacity},createdAt:Date.now(),updatedAt:Date.now()};("line"===M.activeTool||"arrow"===M.activeTool)&&(e.x2=t.x,e.y2=t.y),T(e),S(!0)}},[g,M,J]),U=(0,s.useCallback)(e=>{if(!W)return;let t=J(e);if("path"===M.activeTool)return void L(e=>[...e,t]);if(D)if("line"===D.type||"arrow"===D.type)T({...D,x2:t.x,y2:t.y});else{let e=Math.abs(t.x-D.x),o=Math.abs(t.y-D.y),a=Math.min(D.x,t.x),s=Math.min(D.y,t.y);T({...D,x:a,y:s,width:e,height:o})}},[W,D,J]),X=(0,s.useCallback)(()=>{if(W){if("path"===M.activeTool&&$.length>1){let e=$.reduce((e,t,o)=>0===o?"M ".concat(t.x," ").concat(t.y):"".concat(e," L ").concat(t.x," ").concat(t.y),""),t=Math.min(...$.map(e=>e.x)),o=Math.max(...$.map(e=>e.x)),a=Math.min(...$.map(e=>e.y)),s=Math.max(...$.map(e=>e.y)),l={id:b(),type:"path",x:t,y:a,width:o-t,height:s-a,path:e,style:{stroke:M.strokeColor,strokeWidth:M.strokeWidth,fill:"none",opacity:M.opacity},createdAt:Date.now(),updatedAt:Date.now()};C(e=>({...e,shapes:[...e.shapes,l]})),L([]),S(!1);return}D&&(("line"===D.type||"arrow"===D.type?Math.abs((D.x2||0)-D.x)>1||Math.abs((D.y2||0)-D.y)>1:D.width>1||D.height>1)&&C(e=>({...e,shapes:[...e.shapes,D]})),T(null),S(!1))}},[W,D,$,M]),Y=(0,s.useCallback)(e=>{C(t=>({...t,shapes:t.shapes.filter(t=>t.id!==e),texts:t.texts.filter(t=>t.id!==e)})),E(null)},[]),q=(0,s.useCallback)(()=>{C(f()),E(null)},[]);(0,s.useEffect)(()=>{let e=JSON.stringify(N);null==v||v(e)},[N,v]);let G=(0,s.useCallback)(function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let o={stroke:e.style.stroke,strokeWidth:e.style.strokeWidth,fill:e.style.fill,opacity:e.style.opacity,strokeDasharray:e.style.strokeDasharray,className:t?"cursor-move":"cursor-pointer",onClick:g?()=>E(e.id):void 0};switch(e.type){case"rectangle":return(0,a.jsx)("rect",{x:"".concat(e.x,"%"),y:"".concat(e.y,"%"),width:"".concat(e.width,"%"),height:"".concat(e.height,"%"),...o},e.id);case"circle":let s=e.x+e.width/2,l=e.y+e.height/2,r=e.width/2,n=e.height/2;return(0,a.jsx)("ellipse",{cx:"".concat(s,"%"),cy:"".concat(l,"%"),rx:"".concat(r,"%"),ry:"".concat(n,"%"),...o},e.id);case"line":return(0,a.jsx)("line",{x1:"".concat(e.x,"%"),y1:"".concat(e.y,"%"),x2:"".concat(e.x2||e.x,"%"),y2:"".concat(e.y2||e.y,"%"),...o},e.id);case"arrow":let i=e.x,c=e.y,d=e.x2||e.x,h=e.y2||e.y,x=Math.atan2(h-c,d-i),u=Math.PI/6,p=d-2*Math.cos(x-u),y=h-2*Math.sin(x-u),m=d-2*Math.cos(x+u),f=h-2*Math.sin(x+u);return(0,a.jsxs)("g",{children:[(0,a.jsx)("line",{x1:"".concat(i,"%"),y1:"".concat(c,"%"),x2:"".concat(d,"%"),y2:"".concat(h,"%"),...o}),(0,a.jsx)("line",{x1:"".concat(d,"%"),y1:"".concat(h,"%"),x2:"".concat(p,"%"),y2:"".concat(y,"%"),...o}),(0,a.jsx)("line",{x1:"".concat(d,"%"),y1:"".concat(h,"%"),x2:"".concat(m,"%"),y2:"".concat(f,"%"),...o})]},e.id);case"path":return(0,a.jsx)("path",{d:e.path,stroke:e.style.stroke,strokeWidth:.1*e.style.strokeWidth,fill:"none",opacity:e.style.opacity,strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke",className:t?"cursor-move":"cursor-pointer",onClick:g?()=>E(e.id):void 0},e.id);default:return null}},[g]),H=(0,s.useCallback)((e,t)=>(0,a.jsx)("text",{x:"".concat(e.x,"%"),y:"".concat(e.y,"%"),fontSize:e.style.fontSize,fill:e.style.color,fontFamily:e.style.fontFamily,fontWeight:e.style.fontWeight,textAnchor:"start",dominantBaseline:"hanging",className:t?"cursor-move":g?"cursor-pointer":"",onClick:g?()=>E(e.id):void 0,children:e.text},e.id),[g]);return(0,s.useEffect)(()=>{F(g)},[g]),(0,a.jsxs)("div",{ref:I,className:"absolute inset-0 pointer-events-none ".concat(w),style:{zIndex:k?20:10},children:[(0,a.jsxs)("svg",{ref:B,className:"w-full h-full ".concat(g?"pointer-events-auto":"pointer-events-none"),viewBox:"0 0 100 100",preserveAspectRatio:"none",onMouseDown:O,onMouseMove:U,onMouseUp:X,style:{cursor:g?"select"===M.activeTool?"default":"crosshair":"default"},children:[N.shapes.map(e=>G(e,z===e.id)),N.texts.map(e=>H(e,z===e.id)),D&&G(D,!1,!0),$.length>0&&(0,a.jsx)("path",{d:$.reduce((e,t,o)=>0===o?"M ".concat(t.x," ").concat(t.y):"".concat(e," L ").concat(t.x," ").concat(t.y),""),stroke:M.strokeColor,strokeWidth:.1*M.strokeWidth,fill:"none",opacity:M.opacity,strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"})]}),(0,a.jsx)(l.N,{children:_&&(0,a.jsxs)(r.P.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},transition:{type:"spring",damping:20,stiffness:300},className:"absolute top-4 left-1/2 -translate-x-1/2 pointer-events-auto",children:[(0,a.jsxs)("div",{className:"bg-background border border-border rounded-lg shadow-lg p-2 flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex items-center gap-1 pr-2 border-r border-border",children:[{tool:"select",icon:n.A,title:"Select"},{tool:"rectangle",icon:i.A,title:"Rectangle"},{tool:"circle",icon:c.A,title:"Circle"},{tool:"line",icon:d.A,title:"Line"},{tool:"arrow",icon:h.A,title:"Arrow"},{tool:"path",icon:x.A,title:"Free Draw"},{tool:"text",icon:u.A,title:"Text"}].map(e=>{let{tool:t,icon:o,title:s}=e;return(0,a.jsx)("button",{onClick:()=>A(e=>({...e,activeTool:t})),className:"p-2 rounded hover:bg-muted transition-colors ".concat(M.activeTool===t?"bg-primary text-primary-foreground":""),title:s,children:(0,a.jsx)(o,{className:"w-4 h-4"})},t)})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pr-2 border-r border-border",children:[(0,a.jsx)("button",{onClick:()=>P(!R),className:"p-2 rounded hover:bg-muted transition-colors",title:"Colors",children:(0,a.jsx)(p.A,{className:"w-4 h-4"})}),(0,a.jsx)("div",{className:"w-6 h-6 rounded border-2 border-border",style:{backgroundColor:M.strokeColor}})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:q,className:"p-2 rounded hover:bg-muted transition-colors text-destructive",title:"Clear All",disabled:0===N.shapes.length&&0===N.texts.length,children:(0,a.jsx)(y.A,{className:"w-4 h-4"})}),j&&(0,a.jsx)("button",{onClick:j,className:"p-2 rounded hover:bg-muted transition-colors text-green-600",title:"Save Annotations",children:(0,a.jsx)(m.A,{className:"w-4 h-4"})})]})]}),(0,a.jsx)(l.N,{children:R&&(0,a.jsx)(r.P.div,{initial:{y:-10,opacity:0},animate:{y:0,opacity:1},exit:{y:-10,opacity:0},className:"absolute top-full left-0 mt-2 bg-background border border-border rounded-lg shadow-lg p-3 min-w-[200px]",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Stroke Color"}),(0,a.jsx)("div",{className:"flex gap-2 mt-1",children:["#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#8b5cf6","#000000"].map(e=>(0,a.jsx)("button",{onClick:()=>A(t=>({...t,strokeColor:e})),className:"w-6 h-6 rounded border-2 ".concat(M.strokeColor===e?"border-foreground":"border-border"),style:{backgroundColor:e}},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Stroke Width"}),(0,a.jsx)("input",{type:"range",min:"1",max:"8",value:M.strokeWidth,onChange:e=>A(t=>({...t,strokeWidth:Number(e.target.value)})),className:"w-full mt-1"}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground text-center",children:[M.strokeWidth,"px"]})]})]})})})]})}),(0,a.jsx)(l.N,{children:z&&g&&(0,a.jsx)(r.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"absolute bottom-4 right-4 pointer-events-auto",children:(0,a.jsxs)("div",{className:"bg-background border border-border rounded-lg shadow-lg p-2 flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>Y(z),className:"p-2 rounded hover:bg-destructive/10 text-destructive transition-colors",title:"Delete Selected",children:(0,a.jsx)(y.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>E(null),className:"p-2 rounded hover:bg-muted transition-colors",title:"Deselect",children:(0,a.jsx)(n.A,{className:"w-4 h-4"})})]})})})]})}}}]);